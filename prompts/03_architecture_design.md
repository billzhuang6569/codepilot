# 架构设计模块

基于PRD设计技术架构方案。

## 设计原则
1. **简单易懂**：使用成熟的技术栈
2. **快速开发**：选择开发效率高的框架
3. **易于维护**：模块化设计，代码结构清晰
4. **用户友好**：界面美观，操作简单

## 架构方案模板

### 1. 技术栈选择
根据项目需求推荐合适的技术栈：

#### Web应用
- **前端**：Vue.js 3 + Vuetify 3（美观的UI组件库）
- **后端**：Node.js + Express.js（JavaScript全栈）
- **数据库**：PostgreSQL（通过Supabase）

#### 移动应用
- **跨平台**：React Native 或 Flutter
- **后端**：同Web应用

### 2. 系统架构图
```
[用户界面] <-> [API服务器] <-> [数据库]
     |              |              |
   前端应用      业务逻辑       数据存储
```

### 3. 通俗解释（面向非开发者）

#### 什么是架构？
想象一下盖房子：
- **前端** = 房子的外观和装修（用户看到和操作的界面）
- **后端** = 房子的结构和管道（处理业务逻辑的服务器）
- **数据库** = 房子的储物间（存储所有数据的地方）

#### 为什么选择这个架构？
1. **Vue.js**：就像使用积木搭建界面，简单直观
2. **Node.js**：前后端都用JavaScript，就像说同一种语言，沟通更顺畅
3. **Supabase**：提供现成的数据库服务，就像租用现成的仓库，不用自己建

#### 这个架构的好处
- **开发快**：使用成熟的框架，很多功能都是现成的
- **易维护**：代码结构清晰，就像整理好的衣柜，找东西很方便
- **可扩展**：未来需要新功能时，可以轻松添加

### 4. 模块划分
- **用户模块**：注册、登录、个人信息
- **核心业务模块**：[根据项目具体定义]
- **通用模块**：通知、设置、帮助

### 5. 数据库设计
主要数据表：
- users（用户表）
- [其他业务相关表]

### 6. API设计原则
- RESTful风格
- 统一的错误处理
- 清晰的接口文档

## 执行步骤
1. 分析PRD需求
2. 选择合适的技术栈
3. 设计系统架构
4. 用通俗的语言向用户解释架构
5. 展示架构图和模块划分
6. **获得用户确认后**，再询问是否进入下一阶段

## 架构设计内容

### 1. 系统架构设计
- 整体架构模式（如MVC、微服务、单体应用等）
- 前后端分离策略
- API设计规范
- 数据流设计

### 2. 技术栈详细规划
- 前端框架及版本
- 后端框架及版本
- 数据库选型
- 缓存方案
- 部署方案

### 3. 模块划分
- 核心模块定义
- 模块间依赖关系
- 接口设计
- 数据模型设计

### 4. 安全架构
- 认证授权方案
- 数据加密策略
- API安全措施
- 隐私保护设计

### 5. 性能架构
- 负载均衡策略
- 缓存策略
- 数据库优化方案
- 前端性能优化

## 架构展示格式

```
【系统架构设计】
├── 前端架构
│   ├── 框架：[具体框架和版本]
│   ├── 状态管理：[方案]
│   ├── 路由设计：[策略]
│   └── UI组件库：[选择]
├── 后端架构
│   ├── 框架：[具体框架和版本]
│   ├── API设计：[RESTful/GraphQL等]
│   ├── 中间件：[列表]
│   └── 服务划分：[如果是微服务]
├── 数据层
│   ├── 主数据库：[类型和版本]
│   ├── 缓存：[Redis等]
│   ├── 文件存储：[方案]
│   └── 数据备份：[策略]
└── 部署架构
    ├── 容器化：[Docker等]
    ├── CI/CD：[方案]
    ├── 监控：[工具]
    └── 日志：[方案]
```

询问用户："以上架构设计是否符合您的期望？是否需要调整？"

## 架构数据录入

确认架构后，使用Supabase MCP工具将架构信息录入数据库：

1. 使用 `mcp_supabase_execute_sql` 工具插入架构组件
2. 使用 `mcp_supabase_execute_sql` 工具更新项目技术栈
3. 创建架构相关的项目上下文

## 架构信息结构化输出

**重要**：架构确认后，必须将以下信息整理为结构化格式，供后续数据库初始化使用：

### 技术栈信息（JSON格式）
```json
{
  "frontend": {
    "framework": "[前端框架名称和版本]",
    "ui_library": "[UI组件库]",
    "state_management": "[状态管理方案]"
  },
  "backend": {
    "framework": "[后端框架名称和版本]",
    "language": "[编程语言]",
    "api_style": "[API设计风格，如RESTful]"
  },
  "database": {
    "type": "[数据库类型]",
    "provider": "[数据库提供商，如Supabase]"
  },
  "deployment": {
    "platform": "[部署平台]",
    "containerization": "[容器化方案，如Docker]"
  }
}
```

### 架构设计信息（JSON格式）
```json
{
  "architecture_pattern": "[架构模式，如MVC、微服务等]",
  "system_components": [
    {
      "name": "前端应用层",
      "description": "用户界面和交互逻辑",
      "technology": "[具体技术栈]"
    },
    {
      "name": "API服务层", 
      "description": "后端API接口和业务逻辑",
      "technology": "[具体技术栈]"
    },
    {
      "name": "数据访问层",
      "description": "数据库操作和数据模型",
      "technology": "[具体技术栈]"
    }
  ],
  "security_measures": "[安全措施描述]",
  "performance_considerations": "[性能优化考虑]"
}
```

### 核心模块列表
基于架构设计，确定以下核心模块（这些将存储到 code_architecture 表）：
1. **前端应用层**：用户界面和交互逻辑
2. **API服务层**：后端接口和业务逻辑  
3. **数据访问层**：数据库操作和模型定义
4. **用户认证模块**：注册、登录、权限管理
5. **核心业务模块**：根据PRD定义的主要功能
6. **通用工具模块**：公共函数、工具类、配置

**获得用户确认后**，确保将上述结构化信息传递给数据库初始化步骤。 